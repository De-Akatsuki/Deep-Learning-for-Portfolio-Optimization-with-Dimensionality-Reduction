<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 13.1.0 (20250701.0955)
 -->
<!-- Title: CNN_PCA_Portfolio_Architecture_HighRes Pages: 1 -->
<svg width="273pt" height="720pt"
 viewBox="0.00 0.00 273.00 720.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.785597 0.785597) rotate(0) translate(4 912.5)">
<title>CNN_PCA_Portfolio_Architecture_HighRes</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-912.5 343.75,-912.5 343.75,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<path fill="#e6f2ff" stroke="black" d="M241.12,-908.5C241.12,-908.5 75.12,-908.5 75.12,-908.5 69.12,-908.5 63.12,-902.5 63.12,-896.5 63.12,-896.5 63.12,-878.75 63.12,-878.75 63.12,-872.75 69.12,-866.75 75.12,-866.75 75.12,-866.75 241.12,-866.75 241.12,-866.75 247.12,-866.75 253.12,-872.75 253.12,-878.75 253.12,-878.75 253.12,-896.5 253.12,-896.5 253.12,-902.5 247.12,-908.5 241.12,-908.5"/>
<text xml:space="preserve" text-anchor="middle" x="158.12" y="-895" font-family="Helvetica,sans-Serif" font-size="10.00">Input Layer</text>
<text xml:space="preserve" text-anchor="middle" x="158.12" y="-883.75" font-family="Helvetica,sans-Serif" font-size="10.00">[batch, lookback, 8 assets Ã— 8 features]</text>
<text xml:space="preserve" text-anchor="middle" x="158.12" y="-872.5" font-family="Helvetica,sans-Serif" font-size="10.00">(returns, RSI, MACD, etc.)</text>
</g>
<!-- pca -->
<g id="node2" class="node">
<title>pca</title>
<path fill="#cce6ff" stroke="black" d="M226.5,-814.25C226.5,-814.25 89.75,-814.25 89.75,-814.25 83.75,-814.25 77.75,-808.25 77.75,-802.25 77.75,-802.25 77.75,-784.5 77.75,-784.5 77.75,-778.5 83.75,-772.5 89.75,-772.5 89.75,-772.5 226.5,-772.5 226.5,-772.5 232.5,-772.5 238.5,-778.5 238.5,-784.5 238.5,-784.5 238.5,-802.25 238.5,-802.25 238.5,-808.25 232.5,-814.25 226.5,-814.25"/>
<text xml:space="preserve" text-anchor="middle" x="158.12" y="-800.75" font-family="Helvetica,sans-Serif" font-size="10.00">PCA Layer</text>
<text xml:space="preserve" text-anchor="middle" x="158.12" y="-789.5" font-family="Helvetica,sans-Serif" font-size="10.00">[batch, lookback, 5_components]</text>
<text xml:space="preserve" text-anchor="middle" x="158.12" y="-778.25" font-family="Helvetica,sans-Serif" font-size="10.00">(Dimensionality Reduction)</text>
</g>
<!-- input&#45;&gt;pca -->
<g id="edge1" class="edge">
<title>input&#45;&gt;pca</title>
<path fill="none" stroke="black" d="M158.12,-866.61C158.12,-854.72 158.12,-839.39 158.12,-825.91"/>
<polygon fill="black" stroke="black" points="161.63,-826.18 158.13,-816.18 154.63,-826.18 161.63,-826.18"/>
<text xml:space="preserve" text-anchor="middle" x="195.25" y="-835.45" font-family="Times,serif" font-size="14.00">Raw Features</text>
</g>
<!-- conv_input_prep -->
<g id="node3" class="node">
<title>conv_input_prep</title>
<path fill="#e6f2ff" stroke="black" d="M226.5,-720C226.5,-720 89.75,-720 89.75,-720 83.75,-720 77.75,-714 77.75,-708 77.75,-708 77.75,-696 77.75,-696 77.75,-690 83.75,-684 89.75,-684 89.75,-684 226.5,-684 226.5,-684 232.5,-684 238.5,-690 238.5,-696 238.5,-696 238.5,-708 238.5,-708 238.5,-714 232.5,-720 226.5,-720"/>
<text xml:space="preserve" text-anchor="middle" x="158.12" y="-703.75" font-family="Helvetica,sans-Serif" font-size="10.00">Data Reshape/Permute</text>
<text xml:space="preserve" text-anchor="middle" x="158.12" y="-692.5" font-family="Helvetica,sans-Serif" font-size="10.00">[batch, n_components, lookback]</text>
</g>
<!-- pca&#45;&gt;conv_input_prep -->
<g id="edge2" class="edge">
<title>pca&#45;&gt;conv_input_prep</title>
<path fill="none" stroke="black" d="M158.12,-772.09C158.12,-760.19 158.12,-744.94 158.12,-731.8"/>
<polygon fill="black" stroke="black" points="161.63,-732 158.13,-722 154.63,-732 161.63,-732"/>
<text xml:space="preserve" text-anchor="middle" x="218.88" y="-741.2" font-family="Times,serif" font-size="14.00">Principal Components</text>
</g>
<!-- conv1d_1 -->
<g id="node4" class="node">
<title>conv1d_1</title>
<path fill="#99ccff" stroke="black" d="M224.62,-647C224.62,-647 91.62,-647 91.62,-647 85.62,-647 79.62,-641 79.62,-635 79.62,-635 79.62,-617.25 79.62,-617.25 79.62,-611.25 85.62,-605.25 91.62,-605.25 91.62,-605.25 224.62,-605.25 224.62,-605.25 230.62,-605.25 236.62,-611.25 236.62,-617.25 236.62,-617.25 236.62,-635 236.62,-635 236.62,-641 230.62,-647 224.62,-647"/>
<text xml:space="preserve" text-anchor="middle" x="158.12" y="-633.5" font-family="Helvetica,sans-Serif" font-size="10.00">Conv1D Layer 1</text>
<text xml:space="preserve" text-anchor="middle" x="158.12" y="-622.25" font-family="Helvetica,sans-Serif" font-size="10.00">filters=64, kernel_size=3</text>
<text xml:space="preserve" text-anchor="middle" x="158.12" y="-611" font-family="Helvetica,sans-Serif" font-size="10.00">Output: [batch, 64, (lookback&#45;2)]</text>
</g>
<!-- conv_input_prep&#45;&gt;conv1d_1 -->
<g id="edge3" class="edge">
<title>conv_input_prep&#45;&gt;conv1d_1</title>
<path fill="none" stroke="black" d="M158.12,-683.87C158.12,-676.36 158.12,-667.32 158.12,-658.67"/>
<polygon fill="black" stroke="black" points="161.63,-658.83 158.13,-648.83 154.63,-658.83 161.63,-658.83"/>
</g>
<!-- relu1 -->
<g id="node5" class="node">
<title>relu1</title>
<path fill="#b3d1ff" stroke="black" d="M189.75,-568.25C189.75,-568.25 126.5,-568.25 126.5,-568.25 120.5,-568.25 114.5,-562.25 114.5,-556.25 114.5,-556.25 114.5,-544.25 114.5,-544.25 114.5,-538.25 120.5,-532.25 126.5,-532.25 126.5,-532.25 189.75,-532.25 189.75,-532.25 195.75,-532.25 201.75,-538.25 201.75,-544.25 201.75,-544.25 201.75,-556.25 201.75,-556.25 201.75,-562.25 195.75,-568.25 189.75,-568.25"/>
<text xml:space="preserve" text-anchor="middle" x="158.12" y="-546.38" font-family="Helvetica,sans-Serif" font-size="10.00">ReLU Activation</text>
</g>
<!-- conv1d_1&#45;&gt;relu1 -->
<g id="edge4" class="edge">
<title>conv1d_1&#45;&gt;relu1</title>
<path fill="none" stroke="black" d="M158.12,-604.94C158.12,-597.16 158.12,-588.12 158.12,-579.7"/>
<polygon fill="black" stroke="black" points="161.63,-579.92 158.13,-569.92 154.63,-579.92 161.63,-579.92"/>
</g>
<!-- conv1d_2 -->
<g id="node6" class="node">
<title>conv1d_2</title>
<path fill="#66a3ff" stroke="black" d="M224.62,-495.25C224.62,-495.25 91.62,-495.25 91.62,-495.25 85.62,-495.25 79.62,-489.25 79.62,-483.25 79.62,-483.25 79.62,-465.5 79.62,-465.5 79.62,-459.5 85.62,-453.5 91.62,-453.5 91.62,-453.5 224.62,-453.5 224.62,-453.5 230.62,-453.5 236.62,-459.5 236.62,-465.5 236.62,-465.5 236.62,-483.25 236.62,-483.25 236.62,-489.25 230.62,-495.25 224.62,-495.25"/>
<text xml:space="preserve" text-anchor="middle" x="158.12" y="-481.75" font-family="Helvetica,sans-Serif" font-size="10.00">Conv1D Layer 2</text>
<text xml:space="preserve" text-anchor="middle" x="158.12" y="-470.5" font-family="Helvetica,sans-Serif" font-size="10.00">filters=32, kernel_size=3</text>
<text xml:space="preserve" text-anchor="middle" x="158.12" y="-459.25" font-family="Helvetica,sans-Serif" font-size="10.00">Output: [batch, 32, (lookback&#45;4)]</text>
</g>
<!-- relu1&#45;&gt;conv1d_2 -->
<g id="edge5" class="edge">
<title>relu1&#45;&gt;conv1d_2</title>
<path fill="none" stroke="black" d="M158.12,-532.12C158.12,-524.61 158.12,-515.57 158.12,-506.92"/>
<polygon fill="black" stroke="black" points="161.63,-507.08 158.13,-497.08 154.63,-507.08 161.63,-507.08"/>
</g>
<!-- relu2 -->
<g id="node7" class="node">
<title>relu2</title>
<path fill="#b3d1ff" stroke="black" d="M189.75,-416.5C189.75,-416.5 126.5,-416.5 126.5,-416.5 120.5,-416.5 114.5,-410.5 114.5,-404.5 114.5,-404.5 114.5,-392.5 114.5,-392.5 114.5,-386.5 120.5,-380.5 126.5,-380.5 126.5,-380.5 189.75,-380.5 189.75,-380.5 195.75,-380.5 201.75,-386.5 201.75,-392.5 201.75,-392.5 201.75,-404.5 201.75,-404.5 201.75,-410.5 195.75,-416.5 189.75,-416.5"/>
<text xml:space="preserve" text-anchor="middle" x="158.12" y="-394.62" font-family="Helvetica,sans-Serif" font-size="10.00">ReLU Activation</text>
</g>
<!-- conv1d_2&#45;&gt;relu2 -->
<g id="edge6" class="edge">
<title>conv1d_2&#45;&gt;relu2</title>
<path fill="none" stroke="black" d="M158.12,-453.19C158.12,-445.41 158.12,-436.37 158.12,-427.95"/>
<polygon fill="black" stroke="black" points="161.63,-428.17 158.13,-418.17 154.63,-428.17 161.63,-428.17"/>
</g>
<!-- flatten -->
<g id="node8" class="node">
<title>flatten</title>
<path fill="#e6f2ff" stroke="black" d="M220.12,-343.5C220.12,-343.5 96.13,-343.5 96.13,-343.5 90.12,-343.5 84.12,-337.5 84.12,-331.5 84.12,-331.5 84.12,-319.5 84.12,-319.5 84.12,-313.5 90.12,-307.5 96.12,-307.5 96.12,-307.5 220.12,-307.5 220.12,-307.5 226.12,-307.5 232.12,-313.5 232.12,-319.5 232.12,-319.5 232.12,-331.5 232.12,-331.5 232.12,-337.5 226.12,-343.5 220.12,-343.5"/>
<text xml:space="preserve" text-anchor="middle" x="158.12" y="-327.25" font-family="Helvetica,sans-Serif" font-size="10.00">Flatten Layer</text>
<text xml:space="preserve" text-anchor="middle" x="158.12" y="-316" font-family="Helvetica,sans-Serif" font-size="10.00">Output: [batch, flattened_size]</text>
</g>
<!-- relu2&#45;&gt;flatten -->
<g id="edge7" class="edge">
<title>relu2&#45;&gt;flatten</title>
<path fill="none" stroke="black" d="M158.12,-380.31C158.12,-372.73 158.12,-363.6 158.12,-355.04"/>
<polygon fill="black" stroke="black" points="161.63,-355.04 158.13,-345.04 154.63,-355.04 161.63,-355.04"/>
</g>
<!-- dropout -->
<g id="node9" class="node">
<title>dropout</title>
<path fill="#e6f2ff" stroke="black" d="M184.88,-270.5C184.88,-270.5 131.38,-270.5 131.38,-270.5 125.38,-270.5 119.38,-264.5 119.38,-258.5 119.38,-258.5 119.38,-246.5 119.38,-246.5 119.38,-240.5 125.38,-234.5 131.38,-234.5 131.38,-234.5 184.88,-234.5 184.88,-234.5 190.88,-234.5 196.88,-240.5 196.88,-246.5 196.88,-246.5 196.88,-258.5 196.88,-258.5 196.88,-264.5 190.88,-270.5 184.88,-270.5"/>
<text xml:space="preserve" text-anchor="middle" x="158.12" y="-248.62" font-family="Helvetica,sans-Serif" font-size="10.00">Dropout Layer</text>
</g>
<!-- flatten&#45;&gt;dropout -->
<g id="edge8" class="edge">
<title>flatten&#45;&gt;dropout</title>
<path fill="none" stroke="black" d="M158.12,-307.31C158.12,-299.73 158.12,-290.6 158.12,-282.04"/>
<polygon fill="black" stroke="black" points="161.63,-282.04 158.13,-272.04 154.63,-282.04 161.63,-282.04"/>
</g>
<!-- fc1_hidden -->
<g id="node10" class="node">
<title>fc1_hidden</title>
<path fill="#3366ff" stroke="black" d="M207.38,-197.5C207.38,-197.5 108.88,-197.5 108.88,-197.5 102.88,-197.5 96.88,-191.5 96.88,-185.5 96.88,-185.5 96.88,-173.5 96.88,-173.5 96.88,-167.5 102.88,-161.5 108.88,-161.5 108.88,-161.5 207.38,-161.5 207.38,-161.5 213.38,-161.5 219.38,-167.5 219.38,-173.5 219.38,-173.5 219.38,-185.5 219.38,-185.5 219.38,-191.5 213.38,-197.5 207.38,-197.5"/>
<text xml:space="preserve" text-anchor="middle" x="158.12" y="-181.25" font-family="Helvetica,sans-Serif" font-size="10.00">Fully Connected Layer 1</text>
<text xml:space="preserve" text-anchor="middle" x="158.12" y="-170" font-family="Helvetica,sans-Serif" font-size="10.00">(Hidden: 64 neurons)</text>
</g>
<!-- dropout&#45;&gt;fc1_hidden -->
<g id="edge9" class="edge">
<title>dropout&#45;&gt;fc1_hidden</title>
<path fill="none" stroke="black" d="M158.12,-234.31C158.12,-226.73 158.12,-217.6 158.12,-209.04"/>
<polygon fill="black" stroke="black" points="161.63,-209.04 158.13,-199.04 154.63,-209.04 161.63,-209.04"/>
</g>
<!-- relu3 -->
<g id="node11" class="node">
<title>relu3</title>
<path fill="#b3d1ff" stroke="black" d="M189.75,-124.5C189.75,-124.5 126.5,-124.5 126.5,-124.5 120.5,-124.5 114.5,-118.5 114.5,-112.5 114.5,-112.5 114.5,-100.5 114.5,-100.5 114.5,-94.5 120.5,-88.5 126.5,-88.5 126.5,-88.5 189.75,-88.5 189.75,-88.5 195.75,-88.5 201.75,-94.5 201.75,-100.5 201.75,-100.5 201.75,-112.5 201.75,-112.5 201.75,-118.5 195.75,-124.5 189.75,-124.5"/>
<text xml:space="preserve" text-anchor="middle" x="158.12" y="-102.62" font-family="Helvetica,sans-Serif" font-size="10.00">ReLU Activation</text>
</g>
<!-- fc1_hidden&#45;&gt;relu3 -->
<g id="edge10" class="edge">
<title>fc1_hidden&#45;&gt;relu3</title>
<path fill="none" stroke="black" d="M158.12,-161.31C158.12,-153.73 158.12,-144.6 158.12,-136.04"/>
<polygon fill="black" stroke="black" points="161.63,-136.04 158.13,-126.04 154.63,-136.04 161.63,-136.04"/>
</g>
<!-- sharpe_output -->
<g id="node12" class="node">
<title>sharpe_output</title>
<path fill="#b2e6b2" stroke="black" d="M126.25,-36C126.25,-36 12,-36 12,-36 6,-36 0,-30 0,-24 0,-24 0,-12 0,-12 0,-6 6,0 12,0 12,0 126.25,0 126.25,0 132.25,0 138.25,-6 138.25,-12 138.25,-12 138.25,-24 138.25,-24 138.25,-30 132.25,-36 126.25,-36"/>
<text xml:space="preserve" text-anchor="middle" x="69.12" y="-19.75" font-family="Helvetica,sans-Serif" font-size="10.00">Output: Sharpe Ratio</text>
<text xml:space="preserve" text-anchor="middle" x="69.12" y="-8.5" font-family="Helvetica,sans-Serif" font-size="10.00">[batch, 1] (Linear Activation)</text>
</g>
<!-- relu3&#45;&gt;sharpe_output -->
<g id="edge11" class="edge">
<title>relu3&#45;&gt;sharpe_output</title>
<path fill="none" stroke="black" d="M140.54,-88.41C127.58,-75.82 109.75,-58.48 95.14,-44.29"/>
<polygon fill="black" stroke="black" points="97.67,-41.86 88.06,-37.41 92.79,-46.88 97.67,-41.86"/>
<text xml:space="preserve" text-anchor="middle" x="167.72" y="-57.2" font-family="Times,serif" font-size="14.00">Regression Head</text>
</g>
<!-- weights_output -->
<g id="node13" class="node">
<title>weights_output</title>
<path fill="#85e085" stroke="black" d="M327.75,-36C327.75,-36 168.5,-36 168.5,-36 162.5,-36 156.5,-30 156.5,-24 156.5,-24 156.5,-12 156.5,-12 156.5,-6 162.5,0 168.5,0 168.5,0 327.75,0 327.75,0 333.75,0 339.75,-6 339.75,-12 339.75,-12 339.75,-24 339.75,-24 339.75,-30 333.75,-36 327.75,-36"/>
<text xml:space="preserve" text-anchor="middle" x="248.12" y="-19.75" font-family="Helvetica,sans-Serif" font-size="10.00">Output: Portfolio Weights</text>
<text xml:space="preserve" text-anchor="middle" x="248.12" y="-8.5" font-family="Helvetica,sans-Serif" font-size="10.00">[batch, N assets] (Softmax Activation)</text>
</g>
<!-- relu3&#45;&gt;weights_output -->
<g id="edge12" class="edge">
<title>relu3&#45;&gt;weights_output</title>
<path fill="none" stroke="black" d="M194.85,-88.11C203.1,-83.15 211.39,-77.24 218.12,-70.5 225.02,-63.6 230.9,-54.81 235.58,-46.45"/>
<polygon fill="black" stroke="black" points="238.67,-48.09 240.16,-37.6 232.45,-44.87 238.67,-48.09"/>
<text xml:space="preserve" text-anchor="middle" x="283.52" y="-57.2" font-family="Times,serif" font-size="14.00">Classification Head</text>
</g>
</g>
</svg>
